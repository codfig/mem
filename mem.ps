
% Configurações
/posicoes 28 def
/endinicial 10 def
/momentos 18 def

% Configuração da página
/mmpx {2.83 mul} def % de mm para pixel; A4mm 210x297; A4pxnops 595x842
/largura 180 mmpx def
/altura 270 mmpx def
/margemesq 15 mmpx def
/margemsup 290 15 sub mmpx def % deveria ser 297
/margeminf margemsup altura sub def

% Variáveis e rotinas auxiliares
/deltacoluna largura posicoes div def
/margemdir margemesq largura add def
/deltalinha altura momentos div def

% COMEÇA

%%%%%%%%
% Rótulos de endereço

% Configuração da fonte
/Courier-Bold findfont 9 scalefont setfont
/strlarg {(@10) stringwidth pop} def

endinicial 1 sub
margemesq deltacoluna sub 
posicoes {
    deltacoluna add dup deltacoluna strlarg sub 2 div add  margemsup 4 add moveto
    exch
    (@) show 1 add dup 9 string cvs show
    exch
} repeat pop pop

%%%%%%%
% Caixa principal

% Linhas verticais
margemesq deltacoluna sub
posicoes 1 add
{deltacoluna add dup dup
margemsup moveto
margeminf lineto
stroke} repeat pop

% Linhas verticais
margemsup deltalinha add
momentos 1 add
{deltalinha sub dup dup
margemesq exch moveto
margemdir exch lineto
stroke} repeat pop

%%%%%%%%
% Rótulos de momentos

% Configuração da fonte
/Times-Italic findfont 9 scalefont setfont

0 1 sub
margemsup deltalinha add 
momentos {
    deltalinha sub dup 15 sub  margemdir 4 add exch moveto
    exch
    (t) show 1 add dup 0 -6 rmoveto 9 string cvs show
    exch
} repeat pop pop

showpage
