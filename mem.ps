
% Configurações
/posicoes 28 def
/endinicial 10 def

% Configuração da página
/mmpx {2.83 mul} def % de mm para pixel; A4mm 210x297; A4pxnops 595x842
/largura 180 mmpx def
/altura 270 mmpx def
/margemesq 15 mmpx def
/margemsup 270 15 sub mmpx def % deveria ser 297

% Variáveis e rotinas auxiliares
/deltacoluna largura posicoes div def
/margemdir margemesq largura add def
/baixo margemsup 40 sub def

% Configuração: fontes
/Courier-Bold findfont 9 scalefont setfont

% COMEÇA

% Rótulos de endereço
endinicial 1 sub
margemesq deltacoluna sub 
posicoes {
    deltacoluna add dup deltacoluna 15 sub 2 div add  margemsup 4 add moveto
    exch
    (@) show 1 add dup 9 string cvs show
    exch
} repeat pop pop

% Caixa superior
gsave
2 setlinewidth

% Linhas verticais
margemesq deltacoluna sub
posicoes 1 add
{deltacoluna add dup dup
margemsup moveto
baixo lineto
stroke} repeat pop

margemesq margemsup moveto margemdir margemsup lineto stroke
margemesq baixo moveto margemdir baixo lineto stroke
grestore

showpage
